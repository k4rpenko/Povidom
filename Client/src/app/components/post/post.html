<div class="posts">
    <ng-container *ngIf="loading; else load">
        <div class="posts-skeleton">
        <div class="skeleton-post" *ngFor="let i of [1,2,3]">
            <div class="skeleton-header">
            <div class="skeleton-avatar shimmer"></div>
            <div class="skeleton-user">
                <div class="skeleton-line short shimmer"></div>
                <div class="skeleton-line tiny shimmer"></div>
            </div>
            </div>
            

            <div class="skeleton-content">
            <div class="skeleton-line shimmer"></div>
            <div class="skeleton-line shimmer"></div>
            <div class="skeleton-line half shimmer"></div>
            </div>

            <div class="skeleton-actions">
            <div class="skeleton-icon shimmer"></div>
            <div class="skeleton-icon shimmer"></div>
            <div class="skeleton-icon shimmer"></div>
            <div class="skeleton-icon shimmer"></div>
            </div>
        </div>
        </div>
    </ng-container>
    <ng-template #load>
        <div class="post-item" *ngFor="let post of posts;">
            <div class="post-item-box">
                <div class="post-data" (click)="navigateToPost(post.id!)">

                    <!-- Основний пост -->
                    <div class="post-new">
                        <a [routerLink]="[`/${post.user?.userName}`]" (click)="$event.stopPropagation()"><img [src]="post.user?.avatar" alt="Profile Picture" class="profile-icon"></a>
                        <div class="post-content-info">
                            <div class="post-data-info">
                                <a [routerLink]="[`/${post.user?.userName}`]" (click)="$event.stopPropagation()" class="post-user-info">
                                    <span class="post-author">{{ post.user?.firstName || 'Anonymous' }}</span>
                                    <span class="post-username">{{ post.user?.userName || 'unknown' }}</span>
                                </a>
                                <div class="post-content">
                                <p>{{ post.content || '' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Відповідь на пост, якщо є -->
                    <div class="post-reply" *ngIf="post.answer" (click)="navigateToPost(post.answer.id!); $event.stopPropagation()">
                        <div class="post-reply-item">
                            <img [src]="post.answer.user?.avatar || 'default-avatar-url.jpg'" alt="Reply Profile Picture" class="profile-icon">
                            <div class="post-data-info">
                                <div class="post-user-info">
                                <span class="post-author">{{ post.answer.user?.firstName || 'Anonymous' }}</span>
                                <span class="post-username">{{ post.answer.user?.userName || 'unknown' }}</span>
                                </div>
                                <div class="post-content">
                                <p>{{ post.answer.content || '' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="post-bottom">
                    <div class="post-mut">
                        <div class="post-mut-box">
                        <p>{{post.repostAmount}}</p>
                        <a [ngClass]="post.youRepost ? 'Repost-Added' : 'Repost'" (click)="RepostMenu($event, post.id!.toString()); $event.stopPropagation()">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 24 24" id="repost-round" data-name="Flat Line" class="icon flat-line" stroke="#ffffff" fill="none">
                            <g transform="rotate(90 12 12)">
                                <path id="primary" d="M6,14V9A6,6,0,0,1,16.89,5.54" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
                                <path id="primary-2" d="M18,10v5A6,6,0,0,1,7.11,18.46" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
                                <polyline id="primary-3" points="8 12 6 14 4 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
                                <polyline id="primary-4" points="16 12 18 10 20 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
                            </g>
                            </svg>
                        </a>
                        <div class="repost-menu" *ngIf="openedRepostMenuId === post.id">
                            <a (click)="!post.youRepost ? AddRepost(post) : DeleteRepost(post); $event.stopPropagation()" class="item">Repost</a>
                            <a (click)="openAddPost(); $event.stopPropagation()" class="item">Quote</a>
                        </div>
                        <app-add-post [postQuote]="post" [type]="'quote'" *ngIf="isAddPostOpen" (closed)="closeAddPost()"></app-add-post>
                        </div>
                        <div class="post-mut-box" *ngIf="type !== 'comment'">
                            <p>{{post.commentAmount}}</p>
                            <a class="comment" (click)="$event.stopPropagation()">
                                <svg fill="#ffffff" width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g id="SVGRepo_bgCarrier" stroke-width="0"/>
                                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"/>
                                <g id="SVGRepo_iconCarrier"> <g clip-path="url(#fffclip0_429_11233)"> <path d="M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 13.4876 3.36093 14.891 4 16.1272L3 21L7.8728 20C9.10904 20.6391 10.5124 21 12 21Z" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/> </g> <defs> <clipPath id="clip0_429_11233"> <rect width="24" height="24" fill="white"/> </clipPath> </defs> </g>
                                </svg>
                            </a>
                        </div>
                        <div class="post-mut-box">
                        <p>{{post.likeAmount}}</p>
                        <a (click)="!post.youLike ? likePost(post.id!, post) : DeleteLikePost(post.id!, post); $event.stopPropagation()" class="like">
                            <ng-container *ngIf="!post.youLike; else liked">
                            <svg fill="#fff" xmlns="http://www.w3.org/2000/svg" id="Outline" width="24px" height="20px" viewBox="0 0 24 24"><path d="M17.5,1.917a6.4,6.4,0,0,0-5.5,3.3,6.4,6.4,0,0,0-5.5-3.3A6.8,6.8,0,0,0,0,8.967c0,4.547,4.786,9.513,8.8,12.88a4.974,4.974,0,0,0,6.4,0C19.214,18.48,24,13.514,24,8.967A6.8,6.8,0,0,0,17.5,1.917Zm-3.585,18.4a2.973,2.973,0,0,1-3.83,0C4.947,16.006,2,11.87,2,8.967a4.8,4.8,0,0,1,4.5-5.05A4.8,4.8,0,0,1,11,8.967a1,1,0,0,0,2,0,4.8,4.8,0,0,1,4.5-5.05A4.8,4.8,0,0,1,22,8.967C22,11.87,19.053,16.006,13.915,20.313Z"/></svg>
                            </ng-container>
                            <ng-template #liked>
                            <svg class="LikedTrue" xmlns="http://www.w3.org/2000/svg" id="Filled" width="24px" height="20px" viewBox="0 0 24 24">
                                <path d="M17.5,1.917a6.4,6.4,0,0,0-5.5,3.3,6.4,6.4,0,0,0-5.5-3.3A6.8,6.8,0,0,0,0,8.967c0,4.547,4.786,9.513,8.8,12.88a4.974,4.974,0,0,0,6.4,0C19.214,18.48,24,13.514,24,8.967A6.8,6.8,0,0,0,17.5,1.917Z"/>
                            </svg>
                            </ng-template>
                        </a>
                        </div>
                        <div class="post-mut-box">
                        <p>{{post.viewsAmount}}</p>
                        <a href="" class="views">
                            <svg height="20px" width="20px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" enable-background="new 0 0 50 50" xml:space="preserve" fill="#000000">
                            <g id="SVGRepo_bgCarrier" stroke-width="0" />
                                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" />
                                <g id="SVGRepo_iconCarrier">
                                <path fill="#fff" d="M9.037,40.763h4.286c0.552,0,1-0.447,1-1v-7.314c0-0.553-0.448-1-1-1H9.037c-0.552,0-1,0.447-1,1v7.314 C8.037,40.315,8.485,40.763,9.037,40.763z" />
                                <path fill="#fff" d="M21.894,40.763c0.552,0,1-0.447,1-1v-20.64c0-0.553-0.448-1-1-1h-4.286c-0.552,0-1,0.447-1,1v20.64 c0,0.553,0.448,1,1,1H21.894z" />
                                <path fill="#fff" d="M30.465,40.763c0.552,0,1-0.447,1-1V25.96c0-0.553-0.448-1-1-1H26.18c-0.552,0-1,0.447-1,1v13.803 c0,0.553,0.448,1,1,1H30.465z" />
                                <path fill="#fff" d="M33.751,9.763v30c0,0.553,0.448,1,1,1h4.286c0.552,0,1-0.447,1-1v-30c0-0.553-0.448-1-1-1h-4.286 C34.199,8.763,33.751,9.21,33.751,9.763z" />
                            </g>
                            </svg>
                        </a>
                        </div>
                    </div>
                    <div class="post-bottom-addition">
                        <div class="post-mut">
                        <a (click)="!post.youSaved ? savedPost(post.id!) : UnsavedPost(post.id!); $event.stopPropagation()" class="saved">
                            <ng-container *ngIf="!post.youSaved; else UnSaved">
                            <svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M19 19.2674V7.84496C19 5.64147 17.4253 3.74489 15.2391 3.31522C13.1006 2.89493 10.8994 2.89493 8.76089 3.31522C6.57467 3.74489 5 5.64147 5 7.84496V19.2674C5 20.6038 6.46752 21.4355 7.63416 20.7604L10.8211 18.9159C11.5492 18.4945 12.4508 18.4945 13.1789 18.9159L16.3658 20.7604C17.5325 21.4355 19 20.6038 19 19.2674Z" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                            </ng-container>
                            <ng-template #UnSaved>
                            <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 24 24" fill="none" stroke="#FFD60A">
                                <g id="SVGRepo_bgCarrier" stroke-width="0"/>
                                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"/>
                                <g id="SVGRepo_iconCarrier"> <path d="M15.0309 3.30271C13.0299 2.8991 10.9701 2.8991 8.96913 3.30271C6.66186 3.76809 5 5.82231 5 8.20894V18.6292C5 20.4579 6.9567 21.596 8.51221 20.6721L11.3451 18.9895C11.7496 18.7492 12.2504 18.7492 12.6549 18.9895L15.4878 20.6721C17.0433 21.596 19 20.4579 19 18.6292V8.20894C19 5.82231 17.3381 3.76809 15.0309 3.30271Z" fill="#FFD60A"/> </g>
                            </svg>
                            </ng-template>
                            
                        </a>
                        </div>
                        <div class="post-mut">
                        <a (click)="CopyUrlPost(post.id!); $event.stopPropagation()" class="Copy">
                            <svg  width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke="#CCCCCC" stroke-width="0.35000000000000003"></g><g id="SVGRepo_iconCarrier"> <path d="M12.5 6.25C12.9142 6.25 13.25 5.91421 13.25 5.5C13.25 5.08579 12.9142 4.75 12.5 4.75V6.25ZM20.25 12.5C20.25 12.0858 19.9142 11.75 19.5 11.75C19.0858 11.75 18.75 12.0858 18.75 12.5H20.25ZM19.5 6.25C19.9142 6.25 20.25 5.91421 20.25 5.5C20.25 5.08579 19.9142 4.75 19.5 4.75V6.25ZM15.412 4.75C14.9978 4.75 14.662 5.08579 14.662 5.5C14.662 5.91421 14.9978 6.25 15.412 6.25V4.75ZM20.25 5.5C20.25 5.08579 19.9142 4.75 19.5 4.75C19.0858 4.75 18.75 5.08579 18.75 5.5H20.25ZM18.75 9.641C18.75 10.0552 19.0858 10.391 19.5 10.391C19.9142 10.391 20.25 10.0552 20.25 9.641H18.75ZM20.0303 6.03033C20.3232 5.73744 20.3232 5.26256 20.0303 4.96967C19.7374 4.67678 19.2626 4.67678 18.9697 4.96967L20.0303 6.03033ZM11.9697 11.9697C11.6768 12.2626 11.6768 12.7374 11.9697 13.0303C12.2626 13.3232 12.7374 13.3232 13.0303 13.0303L11.9697 11.9697ZM12.5 4.75H9.5V6.25H12.5V4.75ZM9.5 4.75C6.87665 4.75 4.75 6.87665 4.75 9.5H6.25C6.25 7.70507 7.70507 6.25 9.5 6.25V4.75ZM4.75 9.5V15.5H6.25V9.5H4.75ZM4.75 15.5C4.75 18.1234 6.87665 20.25 9.5 20.25V18.75C7.70507 18.75 6.25 17.2949 6.25 15.5H4.75ZM9.5 20.25H15.5V18.75H9.5V20.25ZM15.5 20.25C18.1234 20.25 20.25 18.1234 20.25 15.5H18.75C18.75 17.2949 17.2949 18.75 15.5 18.75V20.25ZM20.25 15.5V12.5H18.75V15.5H20.25ZM19.5 4.75H15.412V6.25H19.5V4.75ZM18.75 5.5V9.641H20.25V5.5H18.75ZM18.9697 4.96967L11.9697 11.9697L13.0303 13.0303L20.0303 6.03033L18.9697 4.96967Z" fill="#ffffff"></path> </g></svg>
                        </a>
                        </div>
                    </div>
                    </div>

                </div>
            </div>
        </div>
    </ng-template>
</div>
<div class="Message-Box" [class.show]="MessageAction">
    <div class="Message">
    <p>{{MessageText}}</p>
    </div>
</div>